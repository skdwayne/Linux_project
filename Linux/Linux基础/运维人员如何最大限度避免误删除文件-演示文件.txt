
运维人员如何最大限度避免误删除文件

运维===黑锅侠？
		很多工作的网友对运维工作的定位，背黑锅的-----“黑锅侠”！
	企业运维工作中50%以上的故障都是因内部运维人员操作管理失误造成的，“某程”就是个典型例子。
	如果不规范工作中的一举一动，就会不断的犯错，最后导致所有的功劳都变成徒劳。
	那么老男孩老师在10多年的运维工作中是如何高效、智慧运维，不让运维成为黑锅侠的呢？
	且看下文！
简单有效的防止误删数据的技巧
		今天给大家分享一些简单但可以有效的防止误删数据的小技巧：
	操作前备份
			修改或删除数据前请务必备份，最好有异机备份，修改配置等先提交版本管理系统再发布到线上。
	忘了rm吧
		使用mv替代
运维新手删除应使用mv命令替代rm命令，无用的文件不要着急删除，而是移动到回收站/tmp里观察一段时间。
			配置alias别名
			可以通过设置别名等手段屏蔽rm，这样一旦直接用到rm命令就是意识到（当然真想用有手段可以越过别名）。
		让删除变得复杂（即精准删除）
			如果非要删除数据，还可用find结合rm替代单纯的rm，包括设定定时任务等动作执行清理。
			必须用rm？
			如果非要使用rm删除数据，请尽量先切换目录到待删除数据所在的目录。
能不用通配符就不用通配符。
例如：
[root@oldboy /]# cd /oldboy/
[root@oldboy /]# rm -f test1 test2
		必须用rm和通配符？   
如果非要使用rm删除并且要采用通配符，请按下面方法：
	[root@oldboy /]# cd /oldboy/
	[root@oldboy oldboy]# rm -fr *  #目标中最好不要带有“/”，因为“/”太危险
		通配符与rm -fr的结合是极其危险的
应禁止使用类似rm -fr /oldboy/*命令删除
 			这个命令中，目标路径中的任意斜线前后如果多了空格可能会带来灾难。
   	[root@oldboy /]# rm -fr /oldboy/*
    例如:rm -fr /oldboy/空格*   ###*的前不小心多了空格，会删除当前目录下的所有内容。
PS：小手抖一抖数据全没有。
  	
 [root@oldboy /]# rm -fr /oldboy/空格*  #会把当前目录根下全删了。
##习惯-tab补全
如果必须要rm -fr /oldboy/*命令删除，最后的避免错误方法就是要用tab键去补全，不要手敲任何字符，防止误删。
##不要高射炮打蚊子
如果删除的不是目录，就不要用rm -fr，采用最下化的方法rm -f即可，甚至重要的少量文件，可以不用-f，以获得确认删除提示信息。
##福利:补充
额外补充，慎用rsync --delete 
#总结：
A.	删除数据后，多数情况是可以恢复的，但会影响业务.
例如：需要停机恢复，且数据丢了，较长时间用户访问不了对应数据了
B.	恢复工具诸如ext3grep等。
C.	事情发生前未雨绸缪永远比发生了在解决好得多。
D.	养成专业规范的运维习惯
E.	运维流程是避免当黑锅侠的关键！。
#原文地址
原文：http://oldboy.blog.51cto.com/2561410/1687300



